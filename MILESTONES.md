# Project Milestones & Tasks

## ðŸŽ¯ Milestone 1: Basic Infrastructure & Agent Setup
**Goal**: Establish the core Flask application and a LiveKit agent capable of connecting.

- [x] Initialize Flask project structure & config (`config.py`, `.env`).
- [x] Install core dependencies (`Flask`, `python-dotenv`, `livekit-agents`).
- [x] Create basic health check endpoint (`/`).
- [x] Configure LiveKit Cloud credentials (`.env` with `LIVEKIT_URL`, keys).
- [x] Create basic agent structure (`app/agents/voice_agent.py`).
- [x] Implement agent connection logic using `agents.cli.run_app` and `entrypoint` function.
- [x] Verify agent successfully registers with LiveKit Cloud (`python app/agents/voice_agent.py start`).

## ðŸŽ¯ Milestone 2: Agent Interaction & Core Functionality (MVP)
**Goal**: Enable the agent to handle basic voice interactions, collect information, and log it.

- [x] **Agent Connection & Basic Interaction Testing**
    - [x] **Task 2.1:** Test agent interaction via LiveKit Agents Playground.
        - [x] Run agent in `dev` mode: `python app/agents/voice_agent.py dev`.
        - [x] Connect using the Playground ("LiveKit Cloud" tab, Cloud URL + Token).
        - [x] Verify connection and presence in Playground (agent logs confirm job received).
    - [ ] **Task 2.2:** Configure Basic Agent Plugins (STT/LLM/TTS).
        - [ ] Ensure necessary API keys (OpenAI, Cartesia) are in `.env`.
        - [ ] Install required plugin packages (`livekit-agents[openai,cartesia]`).
        - [ ] Uncomment and configure `stt`, `llm`, `tts` in `AgentSession` (`app/agents/voice_agent.py`).
        - [ ] Download required plugin models (`python app/agents/voice_agent.py download-files`).
    - [ ] **Task 2.3:** Test basic STT/LLM/TTS interaction via Playground.
        - [ ] Run agent in `dev` mode.
        - [ ] Speak to the agent via Playground.
        - [ ] Verify audio transcription (STT).
        - [ ] Verify basic response generation (LLM).
        - [ ] Verify spoken response (TTS).
    - [ ] **Task 2.4:** (Placeholder) Test agent interaction via simulated call.
        - [ ] *(Requires call routing setup - `app/routes/call_routes.py`)*.
- [ ] **Implement Core Agent Logic**
    - [ ] Define initial conversation flow (greeting, info gathering).
    - [ ] Implement basic FAQ handling.
    - [ ] Structure agent to collect caller details (name, phone, property, reason).
- [ ] **Implement Basic Ticket Creation/Logging**
    - [ ] Define simple structured format (JSON).
    - [ ] Log collected details + summary to file/console.
- [ ] **Basic Call Routing Setup (Flask)**
    - [ ] Create Flask routes (`app/routes/call_routes.py`) for call webhooks.
    - [ ] Implement logic to trigger the agent on incoming calls.
- [ ] **MVP Deployment Strategy**
    - [ ] Outline deployment steps (Docker, cloud service).

## ðŸŽ¯ Milestone 3: Multi-Tenant System
**Goal**: Convert to a multi-tenant SaaS system.

- [ ] Implement User Authentication & Accounts.
- [ ] Create Client Dashboards.
- [ ] Implement Per-Client Agent Configuration.
- [ ] Integrate Database (User/Client Data, Tickets).

## ðŸŽ¯ Milestone 4: Integrations
**Goal**: Connect the system with external platforms.

- [ ] Implement CRM Integration (e.g., Salesforce, HubSpot).
- [ ] Implement Property Management Software Integration (e.g., AppFolio).
- [ ] Develop API for external access.

## ðŸŽ¯ Milestone 5: Premium Features
**Goal**: Enhance functionality and user experience.

- [ ] Implement Custom Voice Cloning (TTS).
- [ ] Add Multilingual Support.
- [ ] Develop Advanced Call Analytics & Reporting.
- [ ] Implement Sentiment Analysis.

## Current Focus: Milestone 2 - Agent Connection & Basic Interaction Testing
Next immediate tasks:
1.  **Task 2.1:** Test agent interaction via LiveKit Agents Playground.
2.  **Task 2.2:** Configure Basic Agent Plugins (STT/LLM/TTS).
3.  **Task 2.3:** Test basic STT/LLM/TTS interaction via Playground.

This structure uses the `ðŸŽ¯ Milestone X` format and `- [ ]` task lists as before, while incorporating the detailed steps for testing and MVP development. The "Current Focus" section highlights the immediate next steps from Task 2.1 onwards.

## Additional Notes

### Regenerating Token

To regenerate a token for testing with the Playground, you can use the following command:

```bash
lk token \
  --url wss://copilot-veqbluz7.livekit.cloud \
  --api-key API9rFaZWEmxqd8 \
  --api-secret yGB15LWFsGORyjSMjHvEYg6Yq0o8UoKCbmUmMxL7B4P \
  --join \
  --room agent-playground-test-3 \
  --identity playground-user-3 \
  --valid-for 1h
```

Replace the API key/secret if they've changed. Copy the new token generated by this command.

### Testing Connection

1. **Verify Agent is Running & Connected:**
   * Look at the terminal where you ran `python app/agents/voice_agent.py dev`.
   * Is it still running without errors?
   * Does it still show the `registered worker` message for `wss://copilot-veqbluz7.livekit.cloud`?
   * Confirm the port number mentioned in the `see tracing information at http://localhost:XXXXX/debug` line (it was `49180` before, make sure it hasn't changed if you restarted it).

2. **Regenerate Token (Explicitly Targeting Cloud):**
   Let's create a fresh token, making sure it's explicitly tied to your cloud instance URL. This eliminates any ambiguity about which LiveKit server the token is intended for.

   ```bash:MILESTONES.md
   lk token \
     --url wss://copilot-veqbluz7.livekit.cloud \
     --api-key API9rFaZWEmxqd8 \
     --api-secret yGB15LWFsGORyjSMjHvEYg6Yq0o8UoKCbmUmMxL7B4P \
     --join \
     --room agent-playground-test-3 \
     --identity playground-user-3 \
     --valid-for 1h
   ```
   * Replace the API key/secret if they've changed.
   * Copy the new token generated by this command.

3. **Retry Connection with Developer Tools:**
   * Make sure the agent is running.
   * Go to the Playground: [`https://agents-playground.livekit.io/`](https://agents-playground.livekit.io/)
   * **Open Browser Developer Tools:** Press F12 (or right-click -> Inspect -> Console/Network). Go to the "Network" tab and clear any existing entries. Also, keep the "Console" tab visible.
   * Click "Manual".
   * Enter Agent URL: `ws://localhost:49180` (or the correct port from step 1).
   * Paste the **new token** from step 2 into the "Token" field.
   * Click "Connect".
   * **Observe:**
       * **Network Tab:** Look for any requests (especially WebSocket attempts) that turn red or show an error status. Click on them to see details.
       * **Console Tab:** Look for any error messages printed here. They might provide more specific clues than "Failed to fetch".

4. **Check Agent's HTTP Server:** Can you access the agent's debug endpoint directly in your browser? Try opening `http://localhost:49180/debug` (using the correct port). You should see some basic text or JSON if the agent's local HTTP server is reachable. If this fails, the agent isn't listening correctly, or a local firewall is blocking it.

Please perform these steps, paying close attention to the browser's developer console output during the connection attempt, and let me know what you find.